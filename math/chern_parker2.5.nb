(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     39982,       1045]
NotebookOptionsPosition[     35944,        969]
NotebookOutlinePosition[     36336,        985]
CellTagsIndexPosition[     36293,        982]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"kx", "\[Element]", "Reals"}], ",", 
     RowBox[{"ky", "\[Element]", "Reals"}], ",", 
     RowBox[{"k", "\[Element]", "Reals"}], ",", 
     RowBox[{"f", "\[Element]", "Reals"}], ",", 
     RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
     RowBox[{"0", "<=", "\[Phi]", "<", 
      RowBox[{"2", "\[Pi]"}]}], ",", " ", 
     RowBox[{"f", "\[NotEqual]", "0"}]}], "}"}]}], ";"}]}], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"6fe84835-4385-4157-b53a-77bb0bbf1da9"],

Cell[CellGroupData[{

Cell["Berry Curvature and Chern Numbers", "Title",
 CellChangeTimes->{{3.834057511758233*^9, 3.834057537652103*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"cef7ae0b-2e5b-44c4-9f84-7402c9c056f1"],

Cell["\<\
This section following Parker JPP (2021) section 2.5: Alternative form of the \
Berry Curvature using the specific example of the shallow water equations \
given by Delplace et al (2017).\
\>", "Text",
 CellChangeTimes->{{3.8340575501373034`*^9, 3.834057589072628*^9}, 
   3.8341371278768473`*^9, {3.834582166328217*^9, 
   3.834582203947891*^9}},ExpressionUUID->"3a9d3cbe-482e-4a6b-9ead-\
a80879eb60c1"],

Cell[BoxData[
 RowBox[{"inputMatrix", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "kx", ",", " ", "ky"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"kx", ",", " ", "0", ",", " ", 
      RowBox[{"\[ImaginaryI]", " ", "f"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ky", ",", " ", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "f"}], ",", " ", "0"}], "}"}]}], 
   "}"}]}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"5598428f-6518-45cf-9ec8-9c0852f5ddc7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v", "=", 
  RowBox[{"Eigenvectors", "[", "inputMatrix", "]"}]}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"45e38eab-81e7-48af-a5ca-d946cb5d2ad8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "f"}], "kx"]}], ",", 
     RowBox[{"-", 
      FractionBox["ky", "kx"]}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"f", " ", "ky"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "kx", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["f", "2"], "+", 
           SuperscriptBox["kx", "2"], "+", 
           SuperscriptBox["ky", "2"]}]]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "kx", " ", "ky"}], "+", 
        RowBox[{"f", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["f", "2"], "+", 
           SuperscriptBox["kx", "2"], "+", 
           SuperscriptBox["ky", "2"]}]]}]}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["f", "2"], "+", 
          SuperscriptBox["kx", "2"]}], ")"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "kx", " ", "ky"}], "+", 
        RowBox[{"f", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["f", "2"], "+", 
           SuperscriptBox["kx", "2"], "+", 
           SuperscriptBox["ky", "2"]}]]}]}]]}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "f", " ", "ky"}], "+", 
         RowBox[{"kx", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["f", "2"], "+", 
            SuperscriptBox["kx", "2"], "+", 
            SuperscriptBox["ky", "2"]}]]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "kx", " ", "ky"}], "+", 
       RowBox[{"f", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["f", "2"], "+", 
          SuperscriptBox["kx", "2"], "+", 
          SuperscriptBox["ky", "2"]}]]}]}]], ",", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["f", "2"], "+", 
         SuperscriptBox["kx", "2"]}], ")"}]}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "kx", " ", "ky"}], "+", 
       RowBox[{"f", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["f", "2"], "+", 
          SuperscriptBox["kx", "2"], "+", 
          SuperscriptBox["ky", "2"]}]]}]}]], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.834057665818676*^9, 3.834058319388249*^9, 
  3.8340597269302692`*^9, 3.83406954686234*^9, 3.834070155607561*^9, 
  3.834071227505312*^9, 3.834137131094228*^9, 3.834144549076511*^9, 
  3.834145467816139*^9, 3.834228780666585*^9, 3.834229394209322*^9, 
  3.8345705770124207`*^9, 3.8345722620446453`*^9, 3.834579513583569*^9, 
  3.834579962395603*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"c69beca5-bdc5-4041-bbb6-14f1af9179db"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"evec0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Normalize", "[", 
     RowBox[{"v", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "  ", "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evecminus", " ", "=", " ", 
   RowBox[{
    RowBox[{"Normalize", "[", 
     RowBox[{"v", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evecplus", " ", "=", " ", 
   RowBox[{
    RowBox[{"Normalize", "[", 
     RowBox[{"v", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "]"}], " ", "//", "FullSimplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8340576714362297`*^9, 3.8340576966680613`*^9}, {
  3.834059881719714*^9, 3.834059933432129*^9}, {3.83407137480562*^9, 
  3.834071389125355*^9}, {3.8340717107480907`*^9, 3.834071725818362*^9}, {
  3.8341444841358147`*^9, 3.834144540877873*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"a7579f86-3ec5-47de-9413-1c706603c63a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"evals", "=", 
   RowBox[{"Eigenvalues", "[", "inputMatrix", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.834057981136466*^9, 3.834057986342938*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"136dbbe1-f4a1-48af-9e79-1800fb0dc66d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eval0", "=", 
   RowBox[{
    RowBox[{"evals", "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evalminus", "=", 
   RowBox[{
    RowBox[{"evals", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evalplus", "=", 
   RowBox[{
    RowBox[{"evals", "[", 
     RowBox[{"[", "3", "]"}], "]"}], " ", "//", "FullSimplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.834058284393259*^9, 3.834058303267871*^9}, {
  3.834059939342805*^9, 3.834059944660269*^9}, {3.834071392874174*^9, 
  3.834071405168644*^9}, {3.834071730896784*^9, 3.834071744467347*^9}, {
  3.8341444931667013`*^9, 3.834144497342167*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"d2999fb5-70d8-455b-920b-5a5658c16763"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"F221", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"Im", "[", 
      RowBox[{
       RowBox[{"Conjugate", "[", 
        RowBox[{"D", "[", 
         RowBox[{"evecplus", ",", "kx"}], "]"}], "]"}], ".", 
       RowBox[{"D", "[", 
        RowBox[{"evecplus", ",", "ky"}], "]"}]}], "]"}]}], "//", 
    "ComplexExpand"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.8341371855973883`*^9, 3.8341372508434553`*^9}, {
  3.8341445644831343`*^9, 3.834144604292735*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"c7ea53e5-ec5f-4888-8ef4-72b6c1184d62"],

Cell[BoxData[
 FractionBox["f", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["f", "2"], "+", 
     SuperscriptBox["kx", "2"], "+", 
     SuperscriptBox["ky", "2"]}], ")"}], 
   RowBox[{"3", "/", "2"}]]]], "Output",
 CellChangeTimes->{{3.834137232524108*^9, 3.8341372521295023`*^9}, {
   3.834144558262825*^9, 3.834144577377981*^9}, 3.834144609782424*^9, 
   3.834145477069367*^9, 3.834228781466098*^9, 3.8342293947463093`*^9, 
   3.834570581286346*^9, 3.834572271377707*^9, 3.834579516115796*^9, 
   3.834579967517125*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"b06cbec7-08e7-4314-a626-fb083ba2b811"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Berry Curvature for evecplus", "Subsection",
 CellChangeTimes->{{3.834057742101775*^9, 3.834057773870657*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"01959ec2-e015-46d1-9f99-21d901fb9808"],

Cell["\<\
This same method can be applied to the other eigenvectors. However is very \
tedious (see next section for a function that will solve everything).\
\>", "Text",
 CellChangeTimes->{{3.83458222515359*^9, 
  3.834582310220582*^9}},ExpressionUUID->"58746415-0adc-414e-9c0e-\
566a545b3867"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dHk", "=", 
   RowBox[{"D", "[", 
    RowBox[{"inputMatrix", ",", "kx"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dHphi", "=", 
   RowBox[{"D", "[", 
    RowBox[{"inputMatrix", ",", "ky"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ket1", "=", 
   RowBox[{"dHk", ".", "evec0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ket2", "=", 
   RowBox[{"dHphi", ".", "evecplus"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"one", "=", 
   RowBox[{"Dot", "[", 
    RowBox[{
     RowBox[{"Conjugate", "[", "evecplus", "]"}], ",", "ket1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"two", "=", 
   RowBox[{"Dot", "[", 
    RowBox[{
     RowBox[{"Conjugate", "[", "evec0", "]"}], ",", "ket2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"top", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"one", "*", "two"}], "//", "ComplexExpand"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottom", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"evalplus", "-", "eval0"}], ")"}], "^", "2"}], "//", 
    "FullSimplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.834069708763444*^9, 3.834069758166098*^9}, {
  3.834070447309964*^9, 3.834070527247539*^9}, {3.8340705592992153`*^9, 
  3.834070801220119*^9}, {3.834070834955235*^9, 3.8340709887201967`*^9}, {
  3.834071065407456*^9, 3.834071117898576*^9}, {3.834071353391041*^9, 
  3.8340713647353373`*^9}, {3.834071757208303*^9, 3.834071771945326*^9}, {
  3.8340730205138206`*^9, 3.8340730436698627`*^9}, {3.834144633216755*^9, 
  3.834144650303299*^9}, {3.834144795865192*^9, 3.834144796604493*^9}, {
  3.834579600398899*^9, 3.834579603028825*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"d27120f4-a074-457b-ae2a-d39c566e41dd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sumone", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"top", "/", "bottom"}], "//", "ComplexExpand"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.8340698481459513`*^9, 3.834069856070703*^9}, {
  3.834069923340664*^9, 3.834070016831523*^9}, {3.834070141859331*^9, 
  3.8340701447019377`*^9}, {3.8340702510157833`*^9, 3.834070251316633*^9}, {
  3.8340711266548643`*^9, 3.83407112911224*^9}, {3.834144668575635*^9, 
  3.834144670925337*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"4aa9350e-5e6c-44bb-9d37-082c7435c356"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    FractionBox[
     RowBox[{"kx", " ", "ky"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["f", "2"], "+", 
        SuperscriptBox["kx", "2"], "+", 
        SuperscriptBox["ky", "2"]}], ")"}], "2"]], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "f"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["f", "2"], "+", 
        SuperscriptBox["kx", "2"], "+", 
        SuperscriptBox["ky", "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"Sign", "[", "kx", "]"}], "2"]}]]}]], "Output",
 CellChangeTimes->{{3.8340699365112667`*^9, 3.834069952975182*^9}, {
   3.834070006773231*^9, 3.834070018336812*^9}, 3.8340701576177*^9, 
   3.834070260126281*^9, 3.834071129619749*^9, 3.834071229096806*^9, 
   3.83407142679478*^9, 3.834072911079295*^9, {3.834073030817457*^9, 
   3.8340730582182693`*^9}, {3.834144664564382*^9, 3.834144671624462*^9}, 
   3.834228782842557*^9, 3.834229396057294*^9, 3.8345705822048473`*^9, 
   3.8345722733115063`*^9, 3.834579517128399*^9, 3.834579968378611*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"2df980f8-8739-4864-9ee0-3718f9242c46"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ket11", "=", 
   RowBox[{
    RowBox[{"dHk", ".", "evecminus"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ket22", "=", 
   RowBox[{"dHphi", ".", "evecplus"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"one1", "=", 
   RowBox[{
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"Conjugate", "[", "evecplus", "]"}], ",", "ket11"}], "]"}], "//",
     "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"two2", "=", 
   RowBox[{
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"Conjugate", "[", "evecminus", "]"}], ",", "ket22"}], "]"}], "//",
     "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"top2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"one1", "*", "two2"}], "//", "ComplexExpand"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottom2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"evalplus", "-", "evalminus"}], ")"}], "^", "2"}], "//", 
    "FullSimplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.834071162156431*^9, 3.8340712204979153`*^9}, {
  3.834071278521233*^9, 3.834071332367063*^9}, {3.834071469925803*^9, 
  3.8340714709245863`*^9}, {3.834073048035832*^9, 3.834073053895776*^9}, {
  3.83407331997864*^9, 3.834073383591474*^9}, {3.8340734435986433`*^9, 
  3.83407344628685*^9}, {3.834144785616501*^9, 3.834144788145396*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"f016eeab-bdaf-4503-be46-b7494e58085a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sumtwo", "=", 
  RowBox[{
   RowBox[{"top2", "/", "bottom2"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.834070021261793*^9, 3.83407006505774*^9}, {
  3.834070104396072*^9, 3.834070109795259*^9}, {3.83407014750273*^9, 
  3.834070150417994*^9}, {3.834070253331305*^9, 3.834070253621673*^9}, {
  3.834071464617517*^9, 3.834071468257978*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"54696810-58d1-4bec-87a8-9ee099e0ef4d"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.83407006816122*^9, {3.8340701072202253`*^9, 3.834070113325891*^9}, 
   3.834070159850471*^9, 3.8340702633984203`*^9, 3.834071231488304*^9, 
   3.8340714739655247`*^9, 3.8340729144592733`*^9, 3.834073101342021*^9, 
   3.834144700380735*^9, 3.834228783889497*^9, 3.834229397207554*^9, 
   3.834570583217031*^9, 3.8345722751413717`*^9, 3.834579518398232*^9, 
   3.834579969365881*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"922b0a5e-38c3-4a8b-81c6-d8012a5d78bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Fplus225", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"Im", "[", 
      RowBox[{"sumone", "+", "sumtwo"}], "]"}]}], "//", "ComplexExpand"}], "//",
    "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.834070074079891*^9, 3.83407009881674*^9}, {
   3.834070255491748*^9, 3.8340702580434933`*^9}, {3.834071493671295*^9, 
   3.834071545656228*^9}, 3.8340716705896587`*^9, 3.834071700755288*^9, {
   3.8340731056823797`*^9, 3.834073113257221*^9}, {3.8341447128987494`*^9, 
   3.8341447570698013`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"cbff1123-fbbb-4ebf-826a-45ff5e35e63c"],

Cell[BoxData[
 FractionBox["f", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["f", "2"], "+", 
      SuperscriptBox["kx", "2"], "+", 
      SuperscriptBox["ky", "2"]}], ")"}], 
    RowBox[{"3", "/", "2"}]], " ", 
   SuperscriptBox[
    RowBox[{"Sign", "[", "kx", "]"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.8340700906322393`*^9, 3.834070099169424*^9}, 
   3.8340701599388514`*^9, 3.834070264176351*^9, 3.834071233102262*^9, 
   3.834071476183454*^9, {3.834071507503179*^9, 3.8340715460799637`*^9}, {
   3.834071672442902*^9, 3.834071701176841*^9}, 3.834072915793008*^9, 
   3.8340731138586817`*^9, {3.834144702824841*^9, 3.8341447581829*^9}, 
   3.8342287839636087`*^9, 3.834229397277707*^9, 3.834570583271554*^9, 
   3.8345722752512293`*^9, 3.834579518450226*^9, 3.834579969415556*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"db6656a5-3a04-4263-b787-f392b2c1b902"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Fcheck", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Fplus225", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"kx", "\[Rule]", 
        RowBox[{"k", " ", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ",", " ", 
       RowBox[{"ky", "\[Rule]", 
        RowBox[{"k", " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], "}"}]}], "//", 
    "ComplexExpand"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.834144759503848*^9, 3.834144780889696*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"9e6833d4-5eda-4019-906d-ab4d6500ddcd"],

Cell[BoxData[
 FractionBox["f", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["f", "2"], "+", 
     SuperscriptBox["k", "2"]}], ")"}], 
   RowBox[{"3", "/", "2"}]]]], "Output",
 CellChangeTimes->{{3.8341447767747507`*^9, 3.834144781456326*^9}, 
   3.8342287841123457`*^9, 3.834229397407958*^9, 3.8345705834279327`*^9, 
   3.834572275507608*^9, 3.8345795186717176`*^9, 3.834579969573393*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"102bf0da-ba0a-49c4-876a-8d3cd95224f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"chernnum", "=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   RowBox[{"Integrate", "[", 
    RowBox[{"Fplus225", ",", 
     RowBox[{"{", 
      RowBox[{"kx", ",", 
       RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ky", ",", 
       RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8340702132595997`*^9, 3.834070214563719*^9}, 
   3.834144743125805*^9, {3.834144804389084*^9, 3.834144848707951*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"ea5d0d08-83ec-41d4-8f65-bdedaa488e93"],

Cell[BoxData[
 RowBox[{"Sign", "[", "f", "]"}]], "Output",
 CellChangeTimes->{3.834144850696965*^9, 3.8342287848556833`*^9, 
  3.834229397847952*^9, 3.834570584634288*^9, 3.8345722773787003`*^9, 
  3.8345795192826014`*^9, 3.834579970602303*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"86db1fac-a5f4-4174-ae20-95810c62de7b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Chern Functions", "Title",
 CellChangeTimes->{{3.83458233476754*^9, 3.834582336962195*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"a905e32a-eabe-48c8-b7d0-7f53762446bc"],

Cell["\<\
In this section, we define our functions from equations 2.21 and 2.26 again \
from Parker JPP (2021) section 2.5.\
\>", "Text",
 CellChangeTimes->{{3.834582318555279*^9, 
  3.8345823920840473`*^9}},ExpressionUUID->"59e3b5ce-9693-4f15-97e8-\
465790e0b156"],

Cell[CellGroupData[{

Cell["Chern Function Equation 2.21", "Subsection",
 CellChangeTimes->{{3.834144901070689*^9, 3.8341449050277967`*^9}, {
  3.83458192216145*^9, 3.8345819243891068`*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"d1876722-ac62-42c3-86fd-6b2ee641dd39"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chern221", "[", "matrix_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cherns", ",", "vecs", ",", "dim", ",", "chernsp", ",", "chernsm", ",", 
      "deltacherns"}], "}"}], ",", "\[IndentingNewLine]", "\t\t", 
    RowBox[{
     RowBox[{"vecs", "=", 
      RowBox[{"Eigenvectors", "[", "matrix", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"cherns", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"chernsp", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"chernsm", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"dim", "=", 
      RowBox[{
       RowBox[{"Dimensions", "[", "matrix", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"chern", "[", "evec_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "chern", ",", "norm", ",", "bra", ",", "ket", ",", "integrand"}], 
         "}"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"norm", "=", 
          RowBox[{
           RowBox[{"Normalize", "[", "evec", "]"}], "//", "FullSimplify"}]}], 
         ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"bra", "=", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"D", "[", 
            RowBox[{"norm", ",", "kx"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"ket", "=", 
          RowBox[{"D", "[", 
           RowBox[{"norm", ",", "ky"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"integrand", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             RowBox[{"Im", "[", 
              RowBox[{"bra", ".", "ket"}], "]"}]}], "//", "ComplexExpand"}], "//",
            "FullSimplify"}]}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"chern", "=", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"2", " ", "\[Pi]"}]], 
           RowBox[{"Integrate", "[", 
            RowBox[{"integrand", ",", 
             RowBox[{"{", 
              RowBox[{"kx", ",", 
               RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ky", ",", 
               RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
            "]"}]}]}]}]}], "\[IndentingNewLine]", "\t", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"cherns", ",", 
         RowBox[{"chern", "[", 
          RowBox[{"vecs", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "dim"}], "}"}]}], "]"}], ";", "\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"chernsp", ",", 
         RowBox[{"Assuming", "[", 
          RowBox[{
           RowBox[{"f", ">", "0"}], ",", 
           RowBox[{"chern", "[", 
            RowBox[{"vecs", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "dim"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"chernsm", ",", 
         RowBox[{"Assuming", "[", 
          RowBox[{
           RowBox[{"f", "<", "0"}], ",", 
           RowBox[{"chern", "[", 
            RowBox[{"vecs", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "dim"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"deltacherns", "=", 
      RowBox[{"chernsp", "-", "chernsm"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"cherns", ",", "deltacherns"}], "}"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.83423229274725*^9, 3.8342323053537703`*^9}, {
  3.8342323366632423`*^9, 3.834232504356866*^9}, {3.834232571972584*^9, 
  3.834232574346033*^9}, {3.834232637681807*^9, 3.834232637993094*^9}, {
  3.834232735103011*^9, 3.8342327625116043`*^9}, {3.834232838005067*^9, 
  3.834232854135384*^9}, {3.834232948014526*^9, 3.834232948730488*^9}, {
  3.834233403681786*^9, 3.834233665745549*^9}, {3.8342339623220787`*^9, 
  3.834233981744357*^9}, {3.834234184855754*^9, 3.834234213927648*^9}, {
  3.834234454720519*^9, 3.8342344647236223`*^9}, {3.834582090259804*^9, 
  3.8345820921035233`*^9}},ExpressionUUID->"bf729700-11c4-4f81-96c9-\
42eabdfb0619"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"chern221", "[", "inputMatrix", "]"}]], "Input",
 CellChangeTimes->{{3.83423248986922*^9, 3.834232493683598*^9}, {
  3.834233361197682*^9, 3.834233375952498*^9}, {3.834582094886972*^9, 
  3.834582096471352*^9}},ExpressionUUID->"5bd689ce-4545-4fe8-a65f-\
39a8fe2c6087"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      RowBox[{"Sign", "[", "f", "]"}]}], ",", 
     RowBox[{"Sign", "[", "f", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.834234481083082*^9, 3.83457059780651*^9, 
  3.8345722959231243`*^9, 3.834579532817917*^9, 3.834579983395138*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"f583072c-6b9b-4a9d-92c5-52fefd0205dc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Chern Function Equation 2.26", "Subsection",
 CellChangeTimes->{{3.834144901070689*^9, 3.8341449050277967`*^9}, {
  3.83458192216145*^9, 3.8345819386146183`*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"0f09bee0-f83d-4af6-a9ee-d7da5824f838"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chern226", "[", "matrix_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cherns", ",", "vecs", ",", "vals", ",", "dim", ",", "berry", ",", 
      "dHdkx", ",", "dHdky", ",", "chern"}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"vecs", "=", 
      RowBox[{"Eigenvectors", "[", "matrix", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"vals", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Eigenvalues", "[", "matrix", "]"}], "//", "ComplexExpand"}], 
       "//", "FullSimplify"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"dim", "=", 
      RowBox[{
       RowBox[{"Dimensions", "[", "matrix", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"dHdkx", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"matrix", ",", "kx"}], "]"}], "//", "ComplexExpand"}], "//", 
       "FullSimplify"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"dHdky", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"matrix", ",", "ky"}], "]"}], "//", "ComplexExpand"}], "//", 
       "FullSimplify"}]}], ";", "\[IndentingNewLine]", "\t", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sumterms", "[", 
       RowBox[{"m_", ",", "n_"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "ketxm", ",", "ketyn", ",", "ketxn", ",", "ketym", ",", "a", ",", 
          "b", ",", "c", ",", "d", ",", "numerator", ",", "denominator", ",", 
          "summand"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ketxm", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{"dHdkx", ",", 
              RowBox[{"Normalize", "[", 
               RowBox[{"vecs", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "]"}], "//", 
            "ComplexExpand"}], "//", "FullSimplify"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ketyn", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{"dHdky", ",", 
              RowBox[{"Normalize", "[", 
               RowBox[{"vecs", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "]"}]}], "]"}], "//", 
            "ComplexExpand"}], "//", "FullSimplify"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ketxn", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{"dHdkx", ",", 
              RowBox[{"Normalize", "[", 
               RowBox[{"vecs", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "]"}]}], "]"}], "//", 
            "ComplexExpand"}], "//", "FullSimplify"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ketym", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{"dHdky", ",", 
              RowBox[{"Normalize", "[", 
               RowBox[{"vecs", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "]"}], "//", 
            "ComplexExpand"}], "//", "FullSimplify"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"a", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{
              RowBox[{"Conjugate", "[", 
               RowBox[{"Normalize", "[", 
                RowBox[{"vecs", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "]"}], "]"}], ",", "ketxm"}],
              "]"}], "//", "ComplexExpand"}], "//", "FullSimplify"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"b", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{
              RowBox[{"Conjugate", "[", 
               RowBox[{"Normalize", "[", 
                RowBox[{"vecs", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "]"}], "]"}], ",", "ketyn"}],
              "]"}], "//", "ComplexExpand"}], "//", "FullSimplify"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"c", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{
              RowBox[{"Conjugate", "[", 
               RowBox[{"Normalize", "[", 
                RowBox[{"vecs", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "]"}], "]"}], ",", "ketxn"}],
              "]"}], "//", "ComplexExpand"}], "//", "FullSimplify"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{
              RowBox[{"Conjugate", "[", 
               RowBox[{"Normalize", "[", 
                RowBox[{"vecs", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "]"}], "]"}], ",", "ketym"}],
              "]"}], "//", "ComplexExpand"}], "//", "FullSimplify"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"numerator", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"a", "*", "b"}], " ", "-", " ", 
             RowBox[{"c", "*", "d"}]}], "//", "ComplexExpand"}], "//", 
           "FullSimplify"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"denominator", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"vals", "[", 
              RowBox[{"[", "n", "]"}], "]"}], "-", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "m", "]"}], "]"}]}], ")"}], "^", "2"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"summand", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"numerator", "/", "denominator"}], "//", 
            "ComplexExpand"}], "//", "FullSimplify"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "summand", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"berry", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"berry", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                RowBox[{"sumterms", "[", 
                 RowBox[{"i", ",", "j"}], "]"}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "dim"}], "}"}]}], "]"}]}], "//", 
           "ComplexExpand"}], "//", "FullSimplify"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"chern", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"chern", ",", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"2", " ", "\[Pi]"}]], " ", 
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{"berry", "[", 
             RowBox[{"[", "kk", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"kx", ",", 
              RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"ky", ",", 
              RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
           "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"kk", ",", "1", ",", "dim"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "chern", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8345691053882723`*^9, 3.8345691157804527`*^9}, {
   3.834569525148202*^9, 3.834569600860157*^9}, {3.8345697298523293`*^9, 
   3.8345697344336147`*^9}, {3.834569793404848*^9, 3.8345698809271107`*^9}, {
   3.834569916249763*^9, 3.834570571608787*^9}, {3.834581043787076*^9, 
   3.834581055582905*^9}, {3.834581137867305*^9, 3.834581171407321*^9}, {
   3.834581218610898*^9, 3.834581282248321*^9}, {3.834581345096561*^9, 
   3.834581406275069*^9}, {3.834581441367333*^9, 3.8345815233150463`*^9}, {
   3.83458155869956*^9, 3.8345816211957617`*^9}, {3.8345816683586283`*^9, 
   3.834581894730472*^9}, 3.834581941278851*^9},
 CellLabel->
  "In[120]:=",ExpressionUUID->"84e0a9c6-e2e7-472f-8095-5c392d92acab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"chern226", "[", "inputMatrix", "]"}]], "Input",
 CellChangeTimes->{{3.834570639502944*^9, 3.8345706436164103`*^9}, 
   3.834581944246361*^9},
 CellLabel->
  "In[121]:=",ExpressionUUID->"bd36033a-bd7f-43c1-90e1-318dbc6bd6c7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{"-", 
    RowBox[{"Sign", "[", "f", "]"}]}], ",", 
   RowBox[{"Sign", "[", "f", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.834570645157721*^9, 3.834572233554841*^9, 3.834572297542527*^9, 
   3.834579533763741*^9, 3.8345799844467173`*^9, 3.834581062180666*^9, {
   3.834581164483369*^9, 3.834581179599741*^9}, 3.834581287022901*^9, {
   3.8345815154232407`*^9, 3.8345815298361053`*^9}, 3.834581636606147*^9, {
   3.834581727582782*^9, 3.8345817506541986`*^9}, {3.8345818649750013`*^9, 
   3.834581900883802*^9}, {3.8345819449925756`*^9, 3.834581949585292*^9}},
 CellLabel->
  "Out[121]=",ExpressionUUID->"dfadbfef-4710-4b3e-a77f-5b8d94cfcb5f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1188, 974},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f5eb6166-7417-410b-b1c3-7546dce4274f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 645, 14, 52, "Input",ExpressionUUID->"6fe84835-4385-4157-b53a-77bb0bbf1da9"],
Cell[CellGroupData[{
Cell[1228, 38, 204, 3, 114, "Title",ExpressionUUID->"cef7ae0b-2e5b-44c4-9f84-7402c9c056f1"],
Cell[1435, 43, 414, 8, 58, "Text",ExpressionUUID->"3a9d3cbe-482e-4a6b-9ead-a80879eb60c1"],
Cell[1852, 53, 522, 14, 30, "Input",ExpressionUUID->"5598428f-6518-45cf-9ec8-9c0852f5ddc7"],
Cell[CellGroupData[{
Cell[2399, 71, 176, 3, 30, "Input",ExpressionUUID->"45e38eab-81e7-48af-a5ca-d946cb5d2ad8"],
Cell[2578, 76, 3070, 90, 66, "Output",ExpressionUUID->"c69beca5-bdc5-4041-bbb6-14f1af9179db"]
}, Open  ]],
Cell[5663, 169, 1014, 26, 73, "Input",ExpressionUUID->"a7579f86-3ec5-47de-9413-1c706603c63a"],
Cell[6680, 197, 264, 5, 30, "Input",ExpressionUUID->"136dbbe1-f4a1-48af-9e79-1800fb0dc66d"],
Cell[6947, 204, 870, 23, 73, "Input",ExpressionUUID->"d2999fb5-70d8-455b-920b-5a5658c16763"],
Cell[CellGroupData[{
Cell[7842, 231, 617, 16, 30, "Input",ExpressionUUID->"c7ea53e5-ec5f-4888-8ef4-72b6c1184d62"],
Cell[8462, 249, 625, 14, 58, "Output",ExpressionUUID->"b06cbec7-08e7-4314-a626-fb083ba2b811"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9124, 268, 204, 3, 70, "Subsection",ExpressionUUID->"01959ec2-e015-46d1-9f99-21d901fb9808"],
Cell[9331, 273, 295, 6, 35, "Text",ExpressionUUID->"58746415-0adc-414e-9c0e-566a545b3867"],
Cell[9629, 281, 1851, 48, 178, "Input",ExpressionUUID->"d27120f4-a074-457b-ae2a-d39c566e41dd"],
Cell[CellGroupData[{
Cell[11505, 333, 556, 11, 30, "Input",ExpressionUUID->"4aa9350e-5e6c-44bb-9d37-082c7435c356"],
Cell[12064, 346, 1258, 31, 71, "Output",ExpressionUUID->"2df980f8-8739-4864-9ee0-3718f9242c46"]
}, Open  ]],
Cell[13337, 380, 1524, 41, 136, "Input",ExpressionUUID->"f016eeab-bdaf-4503-be46-b7494e58085a"],
Cell[CellGroupData[{
Cell[14886, 425, 458, 8, 30, "Input",ExpressionUUID->"54696810-58d1-4bec-87a8-9ee099e0ef4d"],
Cell[15347, 435, 513, 8, 34, "Output",ExpressionUUID->"922b0a5e-38c3-4a8b-81c6-d8012a5d78bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15897, 448, 645, 14, 30, "Input",ExpressionUUID->"cbff1123-fbbb-4ebf-826a-45ff5e35e63c"],
Cell[16545, 464, 908, 19, 58, "Output",ExpressionUUID->"db6656a5-3a04-4263-b787-f392b2c1b902"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17490, 488, 579, 15, 30, "Input",ExpressionUUID->"9e6833d4-5eda-4019-906d-ab4d6500ddcd"],
Cell[18072, 505, 492, 11, 58, "Output",ExpressionUUID->"102bf0da-ba0a-49c4-876a-8d3cd95224f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18601, 521, 647, 16, 48, "Input",ExpressionUUID->"ea5d0d08-83ec-41d4-8f65-bdedaa488e93"],
Cell[19251, 539, 323, 5, 34, "Output",ExpressionUUID->"86db1fac-a5f4-4174-ae20-95810c62de7b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19635, 551, 185, 3, 114, "Title",ExpressionUUID->"a905e32a-eabe-48c8-b7d0-7f53762446bc"],
Cell[19823, 556, 265, 6, 35, "Text",ExpressionUUID->"59e3b5ce-9693-4f15-97e8-465790e0b156"],
Cell[CellGroupData[{
Cell[20113, 566, 256, 4, 70, "Subsection",ExpressionUUID->"d1876722-ac62-42c3-86fd-6b2ee641dd39"],
Cell[20372, 572, 4812, 118, 433, "Input",ExpressionUUID->"bf729700-11c4-4f81-96c9-42eabdfb0619"],
Cell[CellGroupData[{
Cell[25209, 694, 291, 5, 30, "Input",ExpressionUUID->"5bd689ce-4545-4fe8-a65f-39a8fe2c6087"],
Cell[25503, 701, 515, 13, 34, "Output",ExpressionUUID->"f583072c-6b9b-4a9d-92c5-52fefd0205dc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26067, 720, 256, 4, 70, "Subsection",ExpressionUUID->"0f09bee0-f83d-4af6-a9ee-d7da5824f838"],
Cell[26326, 726, 8591, 213, 692, "Input",ExpressionUUID->"84e0a9c6-e2e7-472f-8095-5c392d92acab"],
Cell[CellGroupData[{
Cell[34942, 943, 248, 5, 30, "Input",ExpressionUUID->"bd36033a-bd7f-43c1-90e1-318dbc6bd6c7"],
Cell[35193, 950, 711, 14, 34, "Output",ExpressionUUID->"dfadbfef-4710-4b3e-a77f-5b8d94cfcb5f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

