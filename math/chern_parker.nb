(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47206,       1206]
NotebookOptionsPosition[     43605,       1143]
NotebookOutlinePosition[     44000,       1159]
CellTagsIndexPosition[     43957,       1156]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Chern Numbers", "Title",
 CellChangeTimes->{{3.8339841292509403`*^9, 
  3.8339841350408363`*^9}},ExpressionUUID->"47d777eb-e875-4ef5-9518-\
afad45b778d4"],

Cell["Kirstin Koepnick & Jeff Oishi", "Author",
 CellChangeTimes->{{3.8339951210377703`*^9, 
  3.833995125668923*^9}},ExpressionUUID->"d36a80c3-2d9a-49fd-8b22-\
9ee115db4974"],

Cell["\<\
Following Parker JPP (2021) section 3. Note that we specify f \[NotEqual] 0.\
\>", "Text",
 CellChangeTimes->{{3.833984141420596*^9, 3.8339841520920553`*^9}, {
  3.833998251993823*^9, 3.833998260293518*^9}, {3.8339982912812357`*^9, 
  3.833998291822332*^9}},ExpressionUUID->"d94886db-a47a-4430-b67e-\
2d51aa8034be"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"kx", "\[Element]", "Reals"}], ",", 
     RowBox[{"ky", "\[Element]", "Reals"}], ",", 
     RowBox[{"k", "\[Element]", "Reals"}], ",", 
     RowBox[{"f", "\[Element]", "Reals"}], ",", 
     RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
     RowBox[{"0", "<=", "\[Phi]", "<", 
      RowBox[{"2", "\[Pi]"}]}], ",", " ", 
     RowBox[{"f", "\[NotEqual]", "0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.833894145273282*^9, 3.833894250117693*^9}, {
   3.833895864397633*^9, 3.833895878770129*^9}, {3.8339951757401*^9, 
   3.833995183953724*^9}, 3.833998112993107*^9, {3.8339981911928997`*^9, 
   3.833998192693673*^9}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"a8f5b55a-b224-4cd8-9427-47d9f84fd218"],

Cell[BoxData[
 RowBox[{"inputMatrix", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "kx", ",", " ", "ky"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"kx", ",", " ", "0", ",", " ", 
      RowBox[{"\[ImaginaryI]", " ", "f"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ky", ",", " ", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "f"}], ",", " ", "0"}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.833891640957201*^9, 3.8338916638961573`*^9}},
 CellLabel->
  "In[267]:=",ExpressionUUID->"178a152d-919e-4c51-8237-b305354d26e7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v", "=", 
  RowBox[{"Eigenvectors", "[", "inputMatrix", "]"}]}]], "Input",
 CellChangeTimes->{{3.833900579592807*^9, 3.83390059813603*^9}, 
   3.833900630407819*^9, 3.8339053782044163`*^9, {3.8339820941842422`*^9, 
   3.83398211600779*^9}},
 CellLabel->
  "In[268]:=",ExpressionUUID->"58fa8976-a241-43fc-b713-6a275f84ae5c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "f"}], "kx"]}], ",", 
     RowBox[{"-", 
      FractionBox["ky", "kx"]}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"f", " ", "ky"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "kx", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["f", "2"], "+", 
           SuperscriptBox["kx", "2"], "+", 
           SuperscriptBox["ky", "2"]}]]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "kx", " ", "ky"}], "+", 
        RowBox[{"f", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["f", "2"], "+", 
           SuperscriptBox["kx", "2"], "+", 
           SuperscriptBox["ky", "2"]}]]}]}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["f", "2"], "+", 
          SuperscriptBox["kx", "2"]}], ")"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "kx", " ", "ky"}], "+", 
        RowBox[{"f", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["f", "2"], "+", 
           SuperscriptBox["kx", "2"], "+", 
           SuperscriptBox["ky", "2"]}]]}]}]]}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "f", " ", "ky"}], "+", 
         RowBox[{"kx", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["f", "2"], "+", 
            SuperscriptBox["kx", "2"], "+", 
            SuperscriptBox["ky", "2"]}]]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "kx", " ", "ky"}], "+", 
       RowBox[{"f", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["f", "2"], "+", 
          SuperscriptBox["kx", "2"], "+", 
          SuperscriptBox["ky", "2"]}]]}]}]], ",", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["f", "2"], "+", 
         SuperscriptBox["kx", "2"]}], ")"}]}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "kx", " ", "ky"}], "+", 
       RowBox[{"f", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["f", "2"], "+", 
          SuperscriptBox["kx", "2"], "+", 
          SuperscriptBox["ky", "2"]}]]}]}]], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.833900518978239*^9, {3.833900580397689*^9, 3.8339005985185003`*^9}, 
   3.833900630755829*^9, 3.833905273551279*^9, 3.833905401070809*^9, 
   3.833905447251101*^9, 3.833905717162355*^9, {3.833982095490315*^9, 
   3.833982116812941*^9}, {3.833983157247394*^9, 3.833983163050123*^9}, {
   3.833983485165853*^9, 3.833983489036009*^9}, 3.8339840662771883`*^9, 
   3.8339951894639177`*^9, {3.833998167882532*^9, 3.833998197804187*^9}},
 CellLabel->
  "Out[268]=",ExpressionUUID->"038ac0c9-1e90-43f8-ad20-5d8015708350"]
}, Open  ]],

Cell[TextData[{
 "In order to match his eigenvectors, we need to rotate them. This isn\
\[CloseCurlyQuote]t interesting in itself; eigenvectors are linear solutions, \
so any complex number can multiply them.\n\nIf you don\[CloseCurlyQuote]t \
make his choice (you can use the commented out multiplications below to use \
it), then you need to be careful to use the ",
 StyleBox["full",
  FontSlant->"Italic"],
 " Berry connection. In his case, the k component of A is purely real, so it \
doesn\[CloseCurlyQuote]t enter the calculation. \n\nHis choice is a bit \
faster, but none of them take very long."
}], "Text",
 CellChangeTimes->{{3.833984116643776*^9, 3.833984119668069*^9}, {
  3.833984157048975*^9, 3.833984235741118*^9}, {3.833997799059403*^9, 
  3.833997849283697*^9}, {3.8339983025214243`*^9, 
  3.833998309631434*^9}},ExpressionUUID->"ccfda278-487c-4e80-aebd-\
aa4f3fafe580"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"evec0", " ", "=", " ", 
   RowBox[{"v", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"kx", "*", 
    RowBox[{"-", "\[ImaginaryI]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evecminus", " ", "=", " ", 
   RowBox[{"v", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"*", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"kx", "^", "2"}], " ", "+", " ", 
        RowBox[{"ky", "^", "2"}]}], ")"}]}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "kx", " ", "ky"}], "+", 
        RowBox[{"f", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["f", "2"], "+", 
           SuperscriptBox["kx", "2"], "+", 
           SuperscriptBox["ky", "2"]}]]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", " ", "ky"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "kx", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["f", "2"], "+", 
           SuperscriptBox["kx", "2"], "+", 
           SuperscriptBox["ky", "2"]}]]}]}], ")"}]}]}], "//", 
    "FullSimplify"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"evecplus", " ", "=", " ", 
  RowBox[{"v", "[", 
   RowBox[{"[", "3", "]"}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"kx", "^", "2"}], " ", "+", " ", 
       RowBox[{"ky", "^", "2"}]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "kx", " ", "ky"}], "+", 
        RowBox[{"f", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["f", "2"], "+", 
           SuperscriptBox["kx", "2"], "+", 
           SuperscriptBox["ky", "2"]}]]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "f", " ", "ky"}], "+", 
          RowBox[{"kx", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["f", "2"], "+", 
             SuperscriptBox["kx", "2"], "+", 
             SuperscriptBox["ky", "2"]}]]}]}], ")"}]}], ")"}]}]}], "//", 
    "FullSimplify"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.833982090415121*^9, 3.8339820904159737`*^9}, {
   3.833982135962797*^9, 3.8339821383469343`*^9}, {3.8339831197461367`*^9, 
   3.833983153433769*^9}, {3.8339834701700478`*^9, 3.833983477996759*^9}, {
   3.833983560932468*^9, 3.833983574100822*^9}, {3.833983605052724*^9, 
   3.833983621888597*^9}, {3.833983655800219*^9, 3.833983676576034*^9}, {
   3.833983903637789*^9, 3.83398394275548*^9}, {3.833983975820719*^9, 
   3.833984024347804*^9}, 3.8339842817727203`*^9, {3.8339844696142397`*^9, 
   3.833984473011772*^9}, {3.8339845647629623`*^9, 3.833984568093501*^9}, {
   3.833996330309009*^9, 3.8339963318927107`*^9}, {3.833996914433188*^9, 
   3.833996917590015*^9}, {3.83399774354029*^9, 3.833997747251148*^9}, {
   3.83399785417801*^9, 3.833997890463176*^9}, {3.833998126333824*^9, 
   3.833998138231942*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"30ebebe9-7a74-4adb-a491-a1ca1e409a5f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "f"}], "kx"]}], ",", 
   RowBox[{"-", 
    FractionBox["ky", "kx"]}], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.833983154022378*^9, 3.833983164252977*^9}, {
   3.833983480277809*^9, 3.833983490480801*^9}, 3.833983574450489*^9, {
   3.833983611344061*^9, 3.8339836221394*^9}, {3.833983657513989*^9, 
   3.833983677229525*^9}, {3.833983919858859*^9, 3.833983943109528*^9}, 
   3.833983978252081*^9, 3.833984025520638*^9, 3.833984066314597*^9, 
   3.833984282704691*^9, 3.833984474789324*^9, 3.8339845688809423`*^9, 
   3.833995189482888*^9, 3.8339963328377*^9, 3.833996918462968*^9, 
   3.833997747770933*^9, {3.833997865910331*^9, 3.833997891270471*^9}, {
   3.8339981679040403`*^9, 3.833998197840682*^9}},
 CellLabel->
  "Out[269]=",ExpressionUUID->"37409da7-b86b-4979-95a9-ef863f514172"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"f", " ", "ky"}], "-", 
      RowBox[{"\[ImaginaryI]", " ", "kx", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["f", "2"], "+", 
         SuperscriptBox["kx", "2"], "+", 
         SuperscriptBox["ky", "2"]}]]}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "kx", " ", "ky"}], "+", 
      RowBox[{"f", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["f", "2"], "+", 
         SuperscriptBox["kx", "2"], "+", 
         SuperscriptBox["ky", "2"]}]]}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["f", "2"], "+", 
        SuperscriptBox["kx", "2"]}], ")"}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "kx", " ", "ky"}], "+", 
      RowBox[{"f", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["f", "2"], "+", 
         SuperscriptBox["kx", "2"], "+", 
         SuperscriptBox["ky", "2"]}]]}]}]]}], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.833983154022378*^9, 3.833983164252977*^9}, {
   3.833983480277809*^9, 3.833983490480801*^9}, 3.833983574450489*^9, {
   3.833983611344061*^9, 3.8339836221394*^9}, {3.833983657513989*^9, 
   3.833983677229525*^9}, {3.833983919858859*^9, 3.833983943109528*^9}, 
   3.833983978252081*^9, 3.833984025520638*^9, 3.833984066314597*^9, 
   3.833984282704691*^9, 3.833984474789324*^9, 3.8339845688809423`*^9, 
   3.833995189482888*^9, 3.8339963328377*^9, 3.833996918462968*^9, 
   3.833997747770933*^9, {3.833997865910331*^9, 3.833997891270471*^9}, {
   3.8339981679040403`*^9, 3.833998197861467*^9}},
 CellLabel->
  "Out[270]=",ExpressionUUID->"bb60a11b-9598-4cf4-b307-d4faf4b8fcef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "f", " ", "ky"}], "+", 
       RowBox[{"kx", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["f", "2"], "+", 
          SuperscriptBox["kx", "2"], "+", 
          SuperscriptBox["ky", "2"]}]]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "kx", " ", "ky"}], "+", 
     RowBox[{"f", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["f", "2"], "+", 
        SuperscriptBox["kx", "2"], "+", 
        SuperscriptBox["ky", "2"]}]]}]}]], ",", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["f", "2"], "+", 
       SuperscriptBox["kx", "2"]}], ")"}]}], 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "kx", " ", "ky"}], "+", 
     RowBox[{"f", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["f", "2"], "+", 
        SuperscriptBox["kx", "2"], "+", 
        SuperscriptBox["ky", "2"]}]]}]}]], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.833983154022378*^9, 3.833983164252977*^9}, {
   3.833983480277809*^9, 3.833983490480801*^9}, 3.833983574450489*^9, {
   3.833983611344061*^9, 3.8339836221394*^9}, {3.833983657513989*^9, 
   3.833983677229525*^9}, {3.833983919858859*^9, 3.833983943109528*^9}, 
   3.833983978252081*^9, 3.833984025520638*^9, 3.833984066314597*^9, 
   3.833984282704691*^9, 3.833984474789324*^9, 3.8339845688809423`*^9, 
   3.833995189482888*^9, 3.8339963328377*^9, 3.833996918462968*^9, 
   3.833997747770933*^9, {3.833997865910331*^9, 3.833997891270471*^9}, {
   3.8339981679040403`*^9, 3.833998197865259*^9}},
 CellLabel->
  "Out[271]=",ExpressionUUID->"38ef76b3-b7a2-4466-b795-96e9690da08b"]
}, Open  ]],

Cell["Change the next cell for evecplus, evecminus, or evec0.", "Text",
 CellChangeTimes->{{3.8339982249578943`*^9, 
  3.8339982372858343`*^9}},ExpressionUUID->"1e0461b5-aa8c-401b-92da-\
2c4259f59a79"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polar", "=", 
  RowBox[{
   RowBox[{"evecplus", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"kx", "\[Rule]", 
       RowBox[{"k", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ",", " ", 
      RowBox[{"ky", "\[Rule]", 
       RowBox[{"k", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], "}"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.833890588035262*^9, 3.833890681571781*^9}, {
   3.8338940953928413`*^9, 3.833894098608445*^9}, {3.83390569284731*^9, 
   3.833905692968515*^9}, {3.833982148554453*^9, 3.8339821506818943`*^9}, {
   3.833983318944137*^9, 3.8339833190733013`*^9}, {3.8339837000909224`*^9, 
   3.833983700498914*^9}, {3.833983757106864*^9, 3.833983771643121*^9}, {
   3.833984062051696*^9, 3.833984062446189*^9}, 3.833984480343202*^9, {
   3.833984573151593*^9, 3.833984573613615*^9}, {3.833997753043871*^9, 
   3.833997753380299*^9}},
 CellLabel->
  "In[272]:=",ExpressionUUID->"672e9957-7cc3-4fdd-b345-d47f410e4f01"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"k", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["f", "2"], "+", 
          SuperscriptBox["k", "2"]}]], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{"f", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"f", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["f", "2"], "+", 
        SuperscriptBox["k", "2"]}]]}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["k", "2"], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]], ",", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["f", "2"], "+", 
       RowBox[{
        SuperscriptBox["k", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Phi]", "]"}], "2"]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"f", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["f", "2"], "+", 
        SuperscriptBox["k", "2"]}]]}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["k", "2"], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.833890682320518*^9, 3.833891212566547*^9, {3.8338913716590023`*^9, 
   3.833891385393895*^9}, 3.833891716309493*^9, 3.833894112323361*^9, {
   3.8338942340432987`*^9, 3.833894256467084*^9}, 3.833895885144808*^9, 
   3.833900672860449*^9, 3.833905118913158*^9, 3.8339051867211637`*^9, 
   3.8339052748518744`*^9, 3.833905402324565*^9, 3.833905447421796*^9, {
   3.833905693432431*^9, 3.833905717296803*^9}, 3.833905838405229*^9, 
   3.833982154530196*^9, 3.833983257792444*^9, 3.8339833197843437`*^9, 
   3.8339837009804163`*^9, {3.833983757660795*^9, 3.833983772098215*^9}, {
   3.833984048156888*^9, 3.833984066412425*^9}, 3.8339844809870443`*^9, 
   3.833984574183517*^9, 3.833995189888928*^9, 3.8339963362251787`*^9, 
   3.833996921297043*^9, 3.833997754422842*^9, 3.8339978946226387`*^9, {
   3.833998168228895*^9, 3.8339981981839323`*^9}},
 CellLabel->
  "Out[272]=",ExpressionUUID->"65ce31c5-67b2-4eb2-8136-e4557bcf9dca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"grhat", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"polar", ",", "k"}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"gphihat", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     FractionBox["1", "k"], ")"}], " ", 
    RowBox[{"D", "[", 
     RowBox[{"polar", ",", "\[Phi]"}], "]"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.833894720747438*^9, 3.8338947399115334`*^9}},
 CellLabel->
  "In[273]:=",ExpressionUUID->"2ab7dd0b-f3e5-49fd-aa60-0c36ea858d16"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"f", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["f", "2"]}], "+", 
       SuperscriptBox["k", "2"], "+", 
       RowBox[{
        SuperscriptBox["k", "2"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["f", "2"], "+", 
          SuperscriptBox["k", "2"]}]], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{"f", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}], 
    RowBox[{"2", " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["f", "2"], "+", 
       SuperscriptBox["k", "2"]}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["f", "2"], "+", 
           SuperscriptBox["k", "2"]}]]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], "2"]}]], ",", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "f", " ", "k", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["k", "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["f", "2"]}], "+", 
          SuperscriptBox["k", "2"]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}]}], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "f", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["f", "2"], "+", 
          SuperscriptBox["k", "2"]}]], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}]}], 
    RowBox[{"2", " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["f", "2"], "+", 
       SuperscriptBox["k", "2"]}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["f", "2"], "+", 
           SuperscriptBox["k", "2"]}]]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], "2"]}]], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.833894740556973*^9, 3.83389588824641*^9, 3.833900746579735*^9, 
   3.8339051203277817`*^9, 3.8339051909291677`*^9, 3.8339052783660297`*^9, 
   3.833905406173128*^9, 3.833905447673094*^9, {3.8339056952845297`*^9, 
   3.83390571734875*^9}, 3.833905839845191*^9, 3.833982226373798*^9, 
   3.833983263530139*^9, 3.833983323845231*^9, 3.833983703026813*^9, {
   3.833983759027336*^9, 3.8339837739942503`*^9}, {3.833984049365425*^9, 
   3.8339840666419*^9}, 3.833984482468515*^9, 3.833984594796954*^9, 
   3.833995190817396*^9, 3.8339963385241737`*^9, 3.833996923672279*^9, 
   3.8339977563287783`*^9, 3.8339978963504143`*^9, {3.833998169140682*^9, 
   3.833998199071871*^9}},
 CellLabel->
  "Out[273]=",ExpressionUUID->"b60ea630-d220-438f-9ed2-3028cf5368db"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["f", "2"]}], "+", 
       SuperscriptBox["k", "2"], "+", 
       RowBox[{
        SuperscriptBox["k", "2"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["f", "2"], "+", 
          SuperscriptBox["k", "2"]}]], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", "f", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "f", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["f", "2"], "+", 
          SuperscriptBox["k", "2"]}]]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["k", "2"], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}], "2"]], ",", 
   FractionBox[
    RowBox[{"k", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["k", "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["f", "2"]}], "+", 
          SuperscriptBox["k", "2"]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}]}], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "f", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["f", "2"], "+", 
          SuperscriptBox["k", "2"]}]], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}]}], 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["f", "2"], "+", 
           SuperscriptBox["k", "2"]}]]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], "2"]}]], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.833894740556973*^9, 3.83389588824641*^9, 3.833900746579735*^9, 
   3.8339051203277817`*^9, 3.8339051909291677`*^9, 3.8339052783660297`*^9, 
   3.833905406173128*^9, 3.833905447673094*^9, {3.8339056952845297`*^9, 
   3.83390571734875*^9}, 3.833905839845191*^9, 3.833982226373798*^9, 
   3.833983263530139*^9, 3.833983323845231*^9, 3.833983703026813*^9, {
   3.833983759027336*^9, 3.8339837739942503`*^9}, {3.833984049365425*^9, 
   3.8339840666419*^9}, 3.833984482468515*^9, 3.833984594796954*^9, 
   3.833995190817396*^9, 3.8339963385241737`*^9, 3.833996923672279*^9, 
   3.8339977563287783`*^9, 3.8339978963504143`*^9, 3.833998169140682*^9, 
   3.833998199665348*^9},
 CellLabel->
  "Out[274]=",ExpressionUUID->"adc2c7bf-e120-4494-9b53-6788707097e6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"conj", "=", 
   RowBox[{
    RowBox[{"Conjugate", "[", "polar", "]"}], "//", "FullSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8338947846016083`*^9, 3.833894796551889*^9}},
 CellLabel->
  "In[275]:=",ExpressionUUID->"f58ce629-e55d-4df7-8db7-0c16b90d9116"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rhat", "=", 
   RowBox[{
    RowBox[{"conj", ".", "grhat"}], "//", "FullSimplify"}]}], 
  RowBox[{"(*", 
   RowBox[{"Not", " ", "included", " ", "since", " ", "real"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"phihat", "=", 
  RowBox[{
   RowBox[{"Dot", "[", 
    RowBox[{"conj", ",", "gphihat"}], "]"}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.833892931816265*^9, 3.833892971926065*^9}, {
   3.833893152133815*^9, 3.833893232650647*^9}, {3.833893294083602*^9, 
   3.8338932965839853`*^9}, {3.833894100666772*^9, 3.83389410090272*^9}, {
   3.833894436239958*^9, 3.833894436638023*^9}, {3.833894492410925*^9, 
   3.83389451114507*^9}, {3.833894672028352*^9, 3.8338946842698717`*^9}, {
   3.8338947683330097`*^9, 3.8338949058150454`*^9}, {3.8338951062078943`*^9, 
   3.833895112093462*^9}, {3.833895751471504*^9, 3.83389576018882*^9}, {
   3.833895841001279*^9, 3.8338958424304247`*^9}, {3.833901573573107*^9, 
   3.8339015893853483`*^9}, 3.833983370859733*^9, {3.833983708386895*^9, 
   3.833983714075145*^9}, 3.8339966701275063`*^9, {3.833996848921638*^9, 
   3.833996850736394*^9}, 3.833996885610244*^9},
 CellLabel->
  "In[276]:=",ExpressionUUID->"afd739c5-4ac6-4a8f-840c-4b08bf262a53"],

Cell[BoxData[
 FractionBox[
  RowBox[{"8", " ", "f", " ", "k", " ", 
   RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["f", "2"], "+", 
        SuperscriptBox["k", "2"]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
     RowBox[{"\[ImaginaryI]", " ", "f", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["f", "2"], "+", 
        SuperscriptBox["k", "2"]}]], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["f", "2"]}], "+", 
     SuperscriptBox["k", "2"], "-", 
     RowBox[{
      SuperscriptBox["k", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "f", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["f", "2"], "+", 
        SuperscriptBox["k", "2"]}], ")"}]}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["k", "2"], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["f", "2"], "+", 
        SuperscriptBox["k", "2"]}]], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.833892953117237*^9, 3.833892973201415*^9}, 
   3.8338931624136467`*^9, {3.833893201691016*^9, 3.833893233351836*^9}, 
   3.833893297293949*^9, 3.833894113515716*^9, {3.8338942354497337`*^9, 
   3.833894257228374*^9}, 3.83389444757021*^9, {3.83389449353963*^9, 
   3.833894511653059*^9}, {3.833894674276054*^9, 3.833894684893878*^9}, 
   3.8338947772524776`*^9, 3.833894818412017*^9, {3.833894888213139*^9, 
   3.8338949062681723`*^9}, 3.833895119020225*^9, 3.833895760890192*^9, {
   3.833895838765628*^9, 3.8338958430795603`*^9}, 3.833895895406754*^9, {
   3.833900815840199*^9, 3.8339008208620157`*^9}, 3.833901589763329*^9, 
   3.8339051233947897`*^9, 3.833905216196561*^9, 3.833905372496311*^9, {
   3.833905430888136*^9, 3.833905447756545*^9}, {3.833905698137677*^9, 
   3.833905717435151*^9}, 3.833905842358818*^9, 3.833983099154138*^9, 
   3.833983272424745*^9, 3.83398333186173*^9, 3.833983714845668*^9, {
   3.8339837614373713`*^9, 3.833983777880558*^9}, {3.833984051701066*^9, 
   3.8339840667440557`*^9}, 3.833984484800552*^9, 3.833984599340308*^9, 
   3.833995192826686*^9, 3.833996345385605*^9, 3.8339966713213043`*^9, 
   3.8339969295185747`*^9, 3.833997762408698*^9, 3.833997898928618*^9, {
   3.8339981709669724`*^9, 3.8339982009265757`*^9}},
 CellLabel->
  "Out[276]=",ExpressionUUID->"9b7c60d0-13ba-422b-8261-8e429372cd9e"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["f", "2"]}], "+", 
      SuperscriptBox["k", "2"], "+", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["f", "2"], "+", 
         SuperscriptBox["k", "2"]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
      RowBox[{"\[ImaginaryI]", " ", "f", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["f", "2"], "+", 
         SuperscriptBox["k", "2"]}]], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"f", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["f", "2"], "+", 
         SuperscriptBox["k", "2"]}]]}], "-", 
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "f", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["f", "2"], "+", 
          SuperscriptBox["k", "2"]}]]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["k", "2"], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}], "2"]}]]}]], "Output",\

 CellChangeTimes->{{3.833892953117237*^9, 3.833892973201415*^9}, 
   3.8338931624136467`*^9, {3.833893201691016*^9, 3.833893233351836*^9}, 
   3.833893297293949*^9, 3.833894113515716*^9, {3.8338942354497337`*^9, 
   3.833894257228374*^9}, 3.83389444757021*^9, {3.83389449353963*^9, 
   3.833894511653059*^9}, {3.833894674276054*^9, 3.833894684893878*^9}, 
   3.8338947772524776`*^9, 3.833894818412017*^9, {3.833894888213139*^9, 
   3.8338949062681723`*^9}, 3.833895119020225*^9, 3.833895760890192*^9, {
   3.833895838765628*^9, 3.8338958430795603`*^9}, 3.833895895406754*^9, {
   3.833900815840199*^9, 3.8339008208620157`*^9}, 3.833901589763329*^9, 
   3.8339051233947897`*^9, 3.833905216196561*^9, 3.833905372496311*^9, {
   3.833905430888136*^9, 3.833905447756545*^9}, {3.833905698137677*^9, 
   3.833905717435151*^9}, 3.833905842358818*^9, 3.833983099154138*^9, 
   3.833983272424745*^9, 3.83398333186173*^9, 3.833983714845668*^9, {
   3.8339837614373713`*^9, 3.833983777880558*^9}, {3.833984051701066*^9, 
   3.8339840667440557`*^9}, 3.833984484800552*^9, 3.833984599340308*^9, 
   3.833995192826686*^9, 3.833996345385605*^9, 3.8339966713213043`*^9, 
   3.8339969295185747`*^9, 3.833997762408698*^9, 3.833997898928618*^9, 
   3.8339981709669724`*^9, 3.8339982018637238`*^9},
 CellLabel->
  "Out[277]=",ExpressionUUID->"a1a20485-b3f5-44f0-9a73-39acdd70e375"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rpot", "=", 
  RowBox[{
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"rhat", "/", 
     RowBox[{"conj", ".", "polar"}]}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"phipot", " ", "=", 
  RowBox[{
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"phihat", "/", 
     RowBox[{"conj", ".", "polar"}]}]}], "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.833890699650977*^9, 3.833890725958852*^9}, {
   3.83389076168534*^9, 3.8338907663531027`*^9}, {3.833890862333997*^9, 
   3.833890877632578*^9}, {3.83389098584354*^9, 3.833891014291976*^9}, {
   3.83389109276021*^9, 3.8338911464027348`*^9}, {3.83389222435329*^9, 
   3.83389222588445*^9}, {3.83389244141698*^9, 3.8338924467047997`*^9}, {
   3.8338926778529778`*^9, 3.8338926924411993`*^9}, {3.833892727511832*^9, 
   3.833892759017337*^9}, {3.8338928978016157`*^9, 3.8338929034655523`*^9}, {
   3.833892997497274*^9, 3.833893010628092*^9}, {3.833893041341028*^9, 
   3.833893050150484*^9}, {3.833893303037245*^9, 3.83389330835736*^9}, {
   3.8338940616021767`*^9, 3.833894067098214*^9}, 3.8338945195676603`*^9, 
   3.833894554252039*^9, {3.833995663781046*^9, 3.833995671037792*^9}, {
   3.833995701741867*^9, 3.833995704588608*^9}, {3.8339961974586897`*^9, 
   3.833996248423875*^9}, {3.8339966939030027`*^9, 3.8339967047624063`*^9}, {
   3.8339968166399612`*^9, 3.833996827537278*^9}, {3.8339968638713703`*^9, 
   3.833996905478036*^9}, {3.833997685252451*^9, 3.8339977009941673`*^9}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"948530ae-2010-4ca1-9bf6-33f8d47a64b7"],

Cell[BoxData[
 FractionBox[
  RowBox[{"f", " ", "k", " ", 
   RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["f", "2"], "+", 
        SuperscriptBox["k", "2"]}]], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
     RowBox[{"f", " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["f", "2"], "+", 
     SuperscriptBox["k", "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"f", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["f", "2"], "+", 
        SuperscriptBox["k", "2"]}]]}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["k", "2"], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.833890722392717*^9, 3.8338907262965603`*^9}, 
   3.833890767051961*^9, 3.833890878734851*^9, {3.833891009974773*^9, 
   3.833891015880958*^9}, {3.833891101652666*^9, 3.8338911476318617`*^9}, 
   3.8338912220808992`*^9, {3.833891375918635*^9, 3.83389138719269*^9}, 
   3.8338917181282063`*^9, 3.8338922263706007`*^9, 3.833892447176898*^9, {
   3.833892681897304*^9, 3.8338926930818577`*^9}, {3.833892728912621*^9, 
   3.8338927606011868`*^9}, 3.83389291681844*^9, 3.833893011797806*^9, 
   3.83389304571589*^9, 3.833893308853622*^9, {3.833894062454976*^9, 
   3.8338940676788273`*^9}, 3.833894115222857*^9, {3.833894236580143*^9, 
   3.833894257807583*^9}, 3.833894519979143*^9, 3.83389455495129*^9, 
   3.8338958988195057`*^9, 3.8339015968655863`*^9, 3.833905125302133*^9, 
   3.8339054477890368`*^9, {3.833905699564982*^9, 3.83390571744734*^9}, 
   3.833905844766493*^9, 3.833983274519038*^9, 3.8339833353318567`*^9, 
   3.833983717491152*^9, {3.833983763061302*^9, 3.833983779461972*^9}, {
   3.8339840533679123`*^9, 3.833984066783885*^9}, 3.833984486072208*^9, 
   3.833984603252131*^9, 3.833995193522238*^9, 3.833995712863312*^9, 
   3.8339962492282953`*^9, 3.8339963512195187`*^9, 3.833996673898815*^9, 
   3.8339967051110573`*^9, 3.83399682799091*^9, {3.8339968922121143`*^9, 
   3.8339969333186007`*^9}, 3.83399770322771*^9, 3.8339977667915497`*^9, 
   3.833997900672817*^9, {3.833998173752797*^9, 3.833998203553143*^9}},
 CellLabel->
  "Out[278]=",ExpressionUUID->"e0460a64-4152-451f-8ec4-1518c1a028ba"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "k", " ", 
   RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["f", "2"], "+", 
        SuperscriptBox["k", "2"]}]], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
     RowBox[{"\[ImaginaryI]", " ", "f", " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"2", " ", "f", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["f", "2"], "+", 
      SuperscriptBox["k", "2"]}], ")"}]}], "+", 
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["k", "2"], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["f", "2"], "+", 
      SuperscriptBox["k", "2"]}]], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}]]], "Output",
 CellChangeTimes->{{3.833890722392717*^9, 3.8338907262965603`*^9}, 
   3.833890767051961*^9, 3.833890878734851*^9, {3.833891009974773*^9, 
   3.833891015880958*^9}, {3.833891101652666*^9, 3.8338911476318617`*^9}, 
   3.8338912220808992`*^9, {3.833891375918635*^9, 3.83389138719269*^9}, 
   3.8338917181282063`*^9, 3.8338922263706007`*^9, 3.833892447176898*^9, {
   3.833892681897304*^9, 3.8338926930818577`*^9}, {3.833892728912621*^9, 
   3.8338927606011868`*^9}, 3.83389291681844*^9, 3.833893011797806*^9, 
   3.83389304571589*^9, 3.833893308853622*^9, {3.833894062454976*^9, 
   3.8338940676788273`*^9}, 3.833894115222857*^9, {3.833894236580143*^9, 
   3.833894257807583*^9}, 3.833894519979143*^9, 3.83389455495129*^9, 
   3.8338958988195057`*^9, 3.8339015968655863`*^9, 3.833905125302133*^9, 
   3.8339054477890368`*^9, {3.833905699564982*^9, 3.83390571744734*^9}, 
   3.833905844766493*^9, 3.833983274519038*^9, 3.8339833353318567`*^9, 
   3.833983717491152*^9, {3.833983763061302*^9, 3.833983779461972*^9}, {
   3.8339840533679123`*^9, 3.833984066783885*^9}, 3.833984486072208*^9, 
   3.833984603252131*^9, 3.833995193522238*^9, 3.833995712863312*^9, 
   3.8339962492282953`*^9, 3.8339963512195187`*^9, 3.833996673898815*^9, 
   3.8339967051110573`*^9, 3.83399682799091*^9, {3.8339968922121143`*^9, 
   3.8339969333186007`*^9}, 3.83399770322771*^9, 3.8339977667915497`*^9, 
   3.833997900672817*^9, 3.833998173752797*^9, 3.833998204055867*^9},
 CellLabel->
  "Out[279]=",ExpressionUUID->"73d3f78e-dce3-4053-b35d-a4f15f39a546"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Should", " ", "be", " ", "pot"}], "=", 
   FractionBox[
    RowBox[{"-", "f"}], 
    RowBox[{"k", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"k", "^", "2"}], "+", 
       RowBox[{"f", "^", "2"}]}], "]"}]}]]}], "*)"}]], "Input",
 CellChangeTimes->{{3.833895924980679*^9, 3.833895944471705*^9}},
 CellLabel->
  "In[280]:=",ExpressionUUID->"dc37cccc-fd83-4322-b378-308343974566"],

Cell["\<\
In this step, we can always use the full computation for the Berry curvature \
to make sure we get the right answer, regardless of rotation.\
\>", "Text",
 CellChangeTimes->{{3.833997926906816*^9, 
  3.83399794768088*^9}},ExpressionUUID->"8dfcaaf9-ab89-4c69-9f77-\
383879016428"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"curve", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "k"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"k", " ", "phipot"}], ",", "k"}], "]"}], " ", "-", " ", 
      RowBox[{"D", "[", 
       RowBox[{"rpot", ",", "\[Phi]"}], "]"}]}], ")"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.833892329682822*^9, 3.833892369032592*^9}, {
  3.833893312090212*^9, 3.833893312386024*^9}, {3.8338938535543547`*^9, 
  3.833893861246772*^9}, {3.833893901103168*^9, 3.8338939065243607`*^9}, {
  3.83389398064388*^9, 3.8338939907431593`*^9}, {3.833894103566671*^9, 
  3.833894106646352*^9}, {3.8339963779435253`*^9, 3.833996424929606*^9}, {
  3.833996486248352*^9, 3.833996489899716*^9}, {3.833996943932863*^9, 
  3.833996970491508*^9}},
 CellLabel->
  "In[281]:=",ExpressionUUID->"fbab0dfb-7f97-4f0a-8988-14fba3fe1cb0"],

Cell[BoxData[
 FractionBox["f", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["f", "2"], "+", 
     SuperscriptBox["k", "2"]}], ")"}], 
   RowBox[{"3", "/", "2"}]]]], "Output",
 CellChangeTimes->{
  3.833997470762334*^9, 3.833997711878459*^9, 3.833997775288763*^9, 
   3.833997902553075*^9, {3.833998179347989*^9, 3.833998207566585*^9}},
 CellLabel->
  "Out[281]=",ExpressionUUID->"11031ed8-c2b8-4150-9f78-93068fa00a0a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Should", " ", "be", " ", "curve"}], "=", 
   FractionBox["f", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", "^", "2"}], "+", 
       RowBox[{"f", "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"3", "/", "2"}], ")"}]}]]}], "*)"}]], "Input",
 CellChangeTimes->{{3.83389595482605*^9, 3.833895976273624*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"08465432-7299-4138-baa8-0a1e5f7a3b14"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chern", "=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", "\[Pi]"}]], 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"curve", " ", "k"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", "0", ",", 
       RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "\[Infinity]"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.833893326781064*^9, 3.833893330097417*^9}, {
   3.833893920451517*^9, 3.833893931559791*^9}, {3.8338940743258963`*^9, 
   3.833894079721908*^9}, {3.833894185196611*^9, 3.833894186360095*^9}, {
   3.833894273080161*^9, 3.833894306968502*^9}, {3.833995722141918*^9, 
   3.833995723897245*^9}, 3.8339965042410173`*^9, {3.833998332419261*^9, 
   3.833998336525868*^9}},
 CellLabel->
  "In[286]:=",ExpressionUUID->"bbf81cb9-5a6f-489f-970f-63c46563909e"],

Cell[BoxData[
 RowBox[{"Sign", "[", "f", "]"}]], "Output",
 CellChangeTimes->{
  3.833893333860259*^9, {3.833893924420627*^9, 3.8338939332393847`*^9}, 
   3.833894080888867*^9, 3.833894117890481*^9, {3.833894239594192*^9, 
   3.833894303415904*^9}, 3.833895903044218*^9, 3.8339016024640007`*^9, 
   3.83390514550611*^9, 3.833905448519603*^9, {3.833905702860366*^9, 
   3.8339057179018087`*^9}, 3.8339058484075403`*^9, 3.833983280991363*^9, {
   3.833983748267131*^9, 3.833983765492462*^9}, 3.833983798564198*^9, {
   3.833984056701334*^9, 3.833984067246644*^9}, 3.8339844888527*^9, 
   3.8339847561189623`*^9, 3.833995430084111*^9, {3.83399649428345*^9, 
   3.833996504577608*^9}, 3.833997720997889*^9, 3.833997785043562*^9, 
   3.833997906598613*^9, {3.833998180065346*^9, 3.8339982081352167`*^9}, 
   3.833998341605826*^9},
 CellLabel->
  "Out[286]=",ExpressionUUID->"a280e600-5662-4aaf-838c-19a394e5c959"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{695.16, 750.6},
WindowMargins->{{1.8, 685.44}, {Automatic, 10.8}},
FrontEndVersion->"12.1 for Linux x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1aa17445-fe61-4987-b8d3-9c875b4d92cd"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 160, 3, 98, "Title",ExpressionUUID->"47d777eb-e875-4ef5-9518-afad45b778d4"],
Cell[743, 27, 175, 3, 32, "Author",ExpressionUUID->"d36a80c3-2d9a-49fd-8b22-9ee115db4974"],
Cell[921, 32, 325, 6, 35, "Text",ExpressionUUID->"d94886db-a47a-4430-b67e-2d51aa8034be"],
Cell[1249, 40, 888, 19, 71, "Input",ExpressionUUID->"a8f5b55a-b224-4cd8-9427-47d9f84fd218"],
Cell[2140, 61, 595, 16, 29, "Input",ExpressionUUID->"178a152d-919e-4c51-8237-b305354d26e7"],
Cell[CellGroupData[{
Cell[2760, 81, 347, 7, 29, "Input",ExpressionUUID->"58fa8976-a241-43fc-b713-6a275f84ae5c"],
Cell[3110, 90, 3160, 92, 119, "Output",ExpressionUUID->"038ac0c9-1e90-43f8-ad20-5d8015708350"]
}, Open  ]],
Cell[6285, 185, 889, 16, 196, "Text",ExpressionUUID->"ccfda278-487c-4e80-aebd-aa4f3fafe580"],
Cell[CellGroupData[{
Cell[7199, 205, 3246, 87, 171, "Input",ExpressionUUID->"30ebebe9-7a74-4adb-a491-a1ca1e409a5f"],
Cell[10448, 294, 907, 18, 49, "Output",ExpressionUUID->"37409da7-b86b-4979-95a9-ef863f514172"],
Cell[11358, 314, 1831, 48, 61, "Output",ExpressionUUID->"bb60a11b-9598-4cf4-b307-d4faf4b8fcef"],
Cell[13192, 364, 1819, 47, 65, "Output",ExpressionUUID->"38ef76b3-b7a2-4466-b795-96e9690da08b"]
}, Open  ]],
Cell[15026, 414, 201, 3, 35, "Text",ExpressionUUID->"1e0461b5-aa8c-401b-92da-2c4259f59a79"],
Cell[CellGroupData[{
Cell[15252, 421, 1006, 22, 29, "Input",ExpressionUUID->"672e9957-7cc3-4fdd-b345-d47f410e4f01"],
Cell[16261, 445, 2316, 58, 64, "Output",ExpressionUUID->"65ce31c5-67b2-4eb2-8136-e4557bcf9dca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18614, 508, 536, 16, 66, "Input",ExpressionUUID->"2ab7dd0b-f3e5-49fd-aa60-0c36ea858d16"],
Cell[19153, 526, 3279, 91, 134, "Output",ExpressionUUID->"b60ea630-d220-438f-9ed2-3028cf5368db"],
Cell[22435, 619, 2977, 82, 134, "Output",ExpressionUUID->"adc2c7bf-e120-4494-9b53-6788707097e6"]
}, Open  ]],
Cell[25427, 704, 302, 8, 29, "Input",ExpressionUUID->"f58ce629-e55d-4df7-8db7-0c16b90d9116"],
Cell[CellGroupData[{
Cell[25754, 716, 1254, 25, 51, "Input",ExpressionUUID->"afd739c5-4ac6-4a8f-840c-4b08bf262a53"],
Cell[27011, 743, 2672, 62, 70, "Output",ExpressionUUID->"9b7c60d0-13ba-422b-8261-8e429372cd9e"],
Cell[29686, 807, 3015, 72, 70, "Output",ExpressionUUID->"a1a20485-b3f5-44f0-9a73-39acdd70e375"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32738, 884, 1576, 28, 51, "Input",ExpressionUUID->"948530ae-2010-4ca1-9bf6-33f8d47a64b7"],
Cell[34317, 914, 2435, 51, 70, "Output",ExpressionUUID->"e0460a64-4152-451f-8ec4-1518c1a028ba"],
Cell[36755, 967, 2369, 49, 67, "Output",ExpressionUUID->"73d3f78e-dce3-4053-b35d-a4f15f39a546"]
}, Open  ]],
Cell[39139, 1019, 449, 13, 37, "Input",ExpressionUUID->"dc37cccc-fd83-4322-b378-308343974566"],
Cell[39591, 1034, 289, 6, 58, "Text",ExpressionUUID->"8dfcaaf9-ab89-4c69-9f77-383879016428"],
Cell[CellGroupData[{
Cell[39905, 1044, 927, 22, 29, "Input",ExpressionUUID->"fbab0dfb-7f97-4f0a-8988-14fba3fe1cb0"],
Cell[40835, 1068, 443, 12, 56, "Output",ExpressionUUID->"11031ed8-c2b8-4150-9f78-93068fa00a0a"]
}, Open  ]],
Cell[41293, 1083, 475, 14, 37, "Input",ExpressionUUID->"08465432-7299-4138-baa8-0a1e5f7a3b14"],
Cell[CellGroupData[{
Cell[41793, 1101, 873, 21, 46, "Input",ExpressionUUID->"bbf81cb9-5a6f-489f-970f-63c46563909e"],
Cell[42669, 1124, 908, 15, 33, "Output",ExpressionUUID->"a280e600-5662-4aaf-838c-19a394e5c959"]
}, Open  ]]
}, Open  ]]
}
]
*)

